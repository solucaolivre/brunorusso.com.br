I"Å<p>Um comando muito √∫til para extrair informa√ß√µes do Active Directory √© o <strong>DSQUERY (</strong><a href="http://technet.microsoft.com/en-us/library/cc732952(v=ws.10).aspx" target="_blank" rel="noopener noreferrer">http://technet.microsoft.com/en-us/library/cc732952(v=ws.10).aspx</a>).</p>
<p>Com ele √© poss√≠vel realizar consultas em diversos tipos de objetos no AD, tais como:</p>
<ul>
<li>Computadores</li>
<li>Contatos</li>
<li>Usu√°rios</li>
<li>Grupos</li>
<li>Servidores</li>
<li>Site</li>
<li>...</li>
</ul>
<p>Mas, ele √© um pouco chato, pois a sintaxe √© muito complexa, mas com o tempo voc√™ acostuma.</p>
<p>Para se ter uma id√©ia de como essa sintaxe √© "chata", veja o exemplo abaixo:</p>
<blockquote><p>dsquery * -filter "&amp;(objectClass=User)(scriptPath=*)" -scope subtree -attr displayName scriptPath &gt;; C:logon_script.txt</p></blockquote>
<p>Nesta consulta, foi utilizada a op√ß√£o dsquery *, que √© utilizada para fazer qualquer consulta com op√ß√µes de filtro.</p>
<p>O filtro utilizado nesta foram os par√¢metros ObjectClass e scriptPath, onde filtra apenas os usu√°rios e qualquer login script.</p>
<p>O resultado deste comando √© direcionado para o arquivo C:logon_script.txt</p>
<p>Dica obtida em:<br />
<a href="http://www.winvistatips.com/ldap-query-specific-logon-script-t757244.html">Http://www.winvistatips.com/ldap-query-specific-logon-script-t757244.html </a></p>
:ET